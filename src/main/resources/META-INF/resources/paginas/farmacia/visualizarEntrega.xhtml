<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	template="/WEB-INF/layout/template.xhtml">

	<ui:define name="title">Visualizar Entrega de Produtos</ui:define>

	<ui:define name="breadcrumb">
		<f:metadata>
			<f:viewParam name="homeOutcome" value="/paginas/principal" />
			<f:viewParam name="value" value="Farmácia,Visualizar" />
			<f:viewParam name="outcome"
				value="/paginas/atendimento/listarAtendimentos.xhtml" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">

		<h:form id="download">
			<p:commandButton id="btnDownloadNota" value="Download Nota"
				ajax="false" process="@this" style="display:none"
				onclick="PrimeFaces.monitorDownload(start, stop);"
				icon="pi fa-download" styleClass="mr-2">
				<p:fileDownload value="#{visualizarEntregaBean.documento}" />
			</p:commandButton>
		</h:form>


		<h:form id="frm">
			<div class="grid">

				<div class="col-12">

					<div class="card">
						<p:fieldset legend="Informações do Paciente" toggleable="true"
							toggleSpeed="500">


							<div class="grid">
								<div class="col-12">
									<div class="ui-fluid">
										<div class="formgrid grid">

											<div class="field col">
												<p:outputLabel value="Nome" />
												<p:inputText readonly="true"
													value="#{visualizarEntregaBean.atendimentoSelecionado.paciente.nomeCompleto}" />
											</div>

											<div class="field col">
												<p:outputLabel value="CPF" />
												<p:inputText readonly="true"
													value="#{visualizarEntregaBean.atendimentoSelecionado.paciente.cpf}" />
											</div>

											<div class="field col">
												<p:outputLabel value="Nº do Prontuário" />
												<p:inputText readonly="true"
													value="#{visualizarEntregaBean.atendimentoSelecionado.paciente.prontuario}" />
											</div>

											<div class="field col">
												<p:outputLabel value="Data de Atendimento" />
												<p:inputText readonly="true"
													value="#{visualizarEntregaBean.atendimentoSelecionado.dataInclusao}">
													<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
												</p:inputText>
											</div>

										</div>
									</div>

								</div>
							</div>


						</p:fieldset>


						<p:fieldset legend="Informações da Retirada" toggleable="true"
							toggleSpeed="500">
							<p:outputPanel id="pnlResp" styleClass="ui-fluid formgrid grid">

								<div class="field col-12 md:col-2">
									<p:outputLabel value="Tipo de Responsavél" />
									<p:inputText readonly="true"
										value="#{visualizarEntregaBean.atendimentoSelecionado.responsavelRetirada.tipoResponsavel.nome}" />
								</div>

								<div class="field col-12 md:col-4">
									<p:outputLabel value="Quem Está Retirando" />
									<p:inputText readonly="true"
										value="#{visualizarEntregaBean.atendimentoSelecionado.responsavelRetirada.nome}" />
								</div>



								<div class="field col-12 md:col-2">
									<p:outputLabel value="CPF/CNPJ" />
									<p:inputText readonly="true"
										value="#{visualizarEntregaBean.atendimentoSelecionado.responsavelRetirada.cpf}" />
								</div>

								<div class="field col-12 md:col-4">
									<p:outputLabel value="Observação" />
									<p:inputText readonly="true"
										value="#{visualizarEntregaBean.atendimentoSelecionado.observacao}" />
								</div>


								<div class="col-12 md:col-12">

									<ui:repeat var="doc"
										value="#{visualizarEntregaBean.atendimentoSelecionado.documentos}">

										<p:commandButton
											value="Baixar #{doc.doc} - #{doc.tipoDocumento.descricao}"
											icon="fa fa-download" style="margin-top:2px;"
											oncomplete="document.getElementById('download:btnDownloadNota').click()"
											action="#{visualizarEntregaBean.prepararDownload}"
											styleClass="green-btn" process="@this" update="@this">

											<f:setPropertyActionListener value="#{doc}"
												target="#{visualizarEntregaBean.docSelecionado}" />

										</p:commandButton>

									</ui:repeat>


								</div>
							</p:outputPanel>
						</p:fieldset>

						<p:fieldset legend="Itens Retirados">

							<ui:repeat
								value="#{visualizarEntregaBean.atendimentoSelecionado.solicitacaoEstoque.itensDaSolicitacao}"
								var="item">

								<div class="ui-fluid formgrid grid">

									<div class="field col-12 md:col-2">
										<p:outputLabel value="Tipo do Produto" />
										<p:inputText value="#{item.produto.categoria.descricao}"
											readonly="true" />
									</div>

									<div class="field col-12 md:col-3">
										<p:outputLabel value="Nome do Produto" />
										<p:inputText value="#{item.produto.descricao}" readonly="true" />
									</div>

									<div class="field col-12 md:col-2">
										<p:outputLabel value="Quantidade Solicitada" />
										<p:inputText value="#{item.quantidadeSolicitada}"
											readonly="true" />
									</div>

									<div class="field col-12 md:col-2">
										<p:outputLabel for="@next" value="Quantidade Entregue" />
										<p:inputText value="#{item.quantidadeEstoque}" readonly="true" />
									</div>

									<p:outputLabel id="pnlJustificativa"
										styleClass="field col-12 md:col-3">

										<p:outputLabel for="@next" value="Justificativa" />
										<p:inputText readonly="true"
											value="#{item.justificativaStatus}" />

									</p:outputLabel>

								</div>

							</ui:repeat>


						</p:fieldset>


						<div align="left">

							<p:button outcome="/paginas/atendimento/relatorios/pesquisarAtendimentos.xhtml"
								value="Voltar" icon="pi pi-delete-left"
								style="margin-top: 10px;margin-left:2px"
								styleClass="ui-button-danger" />

						</div>
					</div>
				</div>
			</div>

		</h:form>

	</ui:define>
</ui:composition>